---
title:    C++ Club UK Meeting 143
author:   Gleb Dolgich
date:     2022-02-03
---

## Why do you like C++?

An amusing [thread](https://www.reddit.com/r/cpp/comments/scri8u/why_do_you_like_c/) on Reddit.

Some replies:

> > I like it because it does what I ask it to do.
> And also because it does not do things I didn't ask it to do [#](https://www.reddit.com/r/cpp/comments/scri8u/why_do_you_like_c/hu8ewp0/)
>
> Philosophy: "Programmers should be free to pick their own programming style, and that style should be fully supported by C++." [#](https://www.reddit.com/r/cpp/comments/scri8u/why_do_you_like_c/hu8axvr/)
>
> I like it because it makes you say “wtf why?” at compile time rather than runtime. [#](https://www.reddit.com/r/cpp/comments/scri8u/why_do_you_like_c/hu8z8ux/)
>
> I don't like C++ except for a singular reason - my employer pays me well for writing C++. [#](https://www.reddit.com/r/cpp/comments/scri8u/why_do_you_like_c/hu9lcwn/)

## 2021-01 ISO C++ mailing

[Mailing](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/#mailing2022-01), [Reddit](https://www.reddit.com/r/cpp/comments/sa68c1/iso_c_january_2022_mailing_available/)

## `const` all the things?

Arthur O'Dwyer wrote [this article](https://quuxplusone.github.io/blog/2022/01/23/dont-const-all-the-things/) on his blog. In it he lists places where he uses `const` and where he doesn't:

Const:

> In function signatures: passing by `const` reference, `const` member functions

No const:

> In function signatures: passing by value
> Data members: never `const`
> > <...> the point of making a class with private members is to preserve invariants among those members. “This never changes” is just one possible invariant. Some people hear “never changes” and think it sounds a bit like `const`, so they slap const on that data member; but you shouldn’t lose sight of the fact that the way we preserve invariants in C++ isn’t with `const`, it’s with `private`.
> Return types: never `const`

Rarely `const`:

> Local variables (_I tend to disagree_)

[Reddit thread](https://www.reddit.com/r/cpp/comments/sbcjek/const_all_the_things/). A few redditors think that locals should be as `const` as possible.

This is [another Reddit thread](https://old.reddit.com/r/cpp/comments/s823vk/declaring_all_variables_local_to_a_function_as/) on making local variables `const`, and most commenters there agree with that.

## Best CPU vs GPU: 879 GB/s Reductions in C++

[This article](https://unum.cloud/post/2022-01-27-accumulate/) iterates through various methods to speed up calculations in C++ using vectorization and parallelization on CPU and GPU. The author provides code snippets that add 1GB floating numbers together and their throughput data. Let's see what are the results.

* Plain C++ and STL: around 5.2--5.3 GB/s
* SIMD AVX2 using intrinsics: 17--22 GB/s
* [OpenMP](https://www.openmp.org): 5.4 GB/s
* Parallel STL based on Intel [Threading Building Blocks](https://www.intel.com/content/www/us/en/developer/tools/oneapi/onetbb.html#gs.nt77ec) (TBB): 80--87 GB/s
* SIMD + Threads: 89 GB/s
* [CUDA](https://www.nvidia.com/en-gb/geforce/technologies/cuda/): 817 GB/s
* [Thrust](https://thrust.github.io): 743 GB/s (nice code!)

```cpp
thrust::reduce(numers.begin(), numbers.end(), float(0), thrust::plus<float>());
```

* [CUB](https://docs.nvidia.com/cuda/cub/index.html): 879 GB/s

This is from Thrust home page:

> Thrust is a parallel algorithms library which resembles the C++ Standard Template Library (STL). Thrust’s high-level interface greatly enhances programmer productivity while enabling performance portability between GPUs and multicore CPUs. Interoperability with established technologies (such as CUDA, TBB, and OpenMP) facilitates integration with existing software.

Of all the above, based on the presented code snippets, I would choose Thrust.
