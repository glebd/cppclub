<!-- page_number: true -->
<!-- $size: 16:9 -->

# C++ Club

## 24 August 2017

---

# LLVM now supports PDB on Windows

[Post](http://blog.llvm.org/2017/08/llvm-on-windows-now-supports-pdb-debug.html)

* CodeView format: Microsoft, mid-1980's, poorly documented
* Linux: DWARF
* PDB = CodeView + database (completely undocumented)

> I got some odd stares (to put it lightly) when I suggested that we just ask Microsoft if they would help us out.  But ultimately we did, and… they agreed!

Microsoft: `cvdump`, LLVM: `llvm-pdbutil`

---

# GCC 7.2 released

[Announcement](https://gcc.gnu.org/ml/gcc/2017-08/msg00129.html)

* Bugfix release (>95 bugs fixed)
* [Changes in GCC 7](https://gcc.gnu.org/gcc-7/changes.html)

---

# Outcome v2 is stable

* [Reddit post](https://www.reddit.com/r/cpp/comments/6qo1m3/outcome_v2_has_reached_stability_wg21_paper_will/)
* Ready for the 2nd Boost review
* Deployed in 2 libs
* Shots fired!

> I know those coming from Rust-land feel amazement how long it has taken C++ to replicate Rust's `Result<T, E>`, but I'm very sure ours is enormously superior to theirs already simply by doing so much less because it doesn't need to. Taking time to get design right is one of the big things which continues to separate C++ from the upstart systems programming languages. Long may it continue!

* You'll never guess what happened next.

---

# Mutable Lambdas

[Blog post](https://mayankj08.github.io/2017/08/06/Mutable-Lambdas-In-C++/)

---

# Beware of C++ - Nicolai Josuttis - C++Now 2014 Keynote

[YouTube](https://www.youtube.com/watch?v=tCM4wP-dWic)

> We need guidelines on how to use C++ features

* `noexcept`: HH did a test with a move ctor => 10 times faster with `noexcept`
* Should we have semantics for "strongly encouraged to be `noexcept`"?
* Issues with constructors, initializer lists and `explicit`
* Guidelines for `constexpr`
* The many iterations of `std::make_pair`
* Guidelines for template parameters

[C++ Core Guidelines](https://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines)

---

# The Speed Game: Automated Trading Systems in C++ - Carl Cook - Meeting C++ 2016

[YouTube](https://www.youtube.com/watch?v=ulOLGX3HNCI)

* A few important lines of code
* Millions of market data events per second
* Jitter is a killer
* Latency, not throughput
* No mistakes (or very good recovery)
* Know your hardware
* Don't try to be an optimizing compiler
* Cache warming
* Bypass the kernel (user-space code, incl. networking - OpenOnload)

---

# The Speed Game: Automated Trading Systems in C++ - Carl Cook - Meeting C++ 2016 (cont.)

[YouTube](https://www.youtube.com/watch?v=ulOLGX3HNCI)

* Compile-time dispatch
* `constexpr`
* Variadic templates
* Loop unrolling
* Expression short-circuiting
* Branch prediction/reduction
* Avoiding allocations; placement `new`
* Fast containers
* LTO

---

# The Speed Game: Automated Trading Systems in C++ - Carl Cook - Meeting C++ 2016 (cont.)

[YouTube](https://www.youtube.com/watch?v=ulOLGX3HNCI)

Downsides of C++:

* Zero-size vectors may have a cost
* `std::function` allocates memory
* x86 has a stronger memory model than C++11
    * you see fewer concurrency bugs, but at a performance cost
* Standard containers and allocators are non-deterministic in runtime cost

[SG14 Google group](https://groups.google.com/a/isocpp.org/forum/#!forum/sg14)

---

# Type_safe by Jonathan Müller

* Zero overhead utilities for preventing bugs at compile time (MIT)
* [GitHub](https://github.com/foonathan/type_safe) :: [Docs](http://foonathan.net/doc/type_safe/)
* C++11
* Header-only
* [Reddit thread on constraining parameter values](https://www.reddit.com/r/cpp/comments/6uof6s/constraining_parameter_values/)

---

# "At first I loved `auto`, now I'm just annoyed by it"

* [Reddit thread](https://www.reddit.com/r/cpp/comments/6uj4df/at_first_i_loved_auto_now_i_am_just_annoyed_with/)
* Use everywhere or only when it can't be avoided?
* Use only for iteratots, range for loops and lambdas?
* [Video: "Autofobia"](https://www.youtube.com/watch?v=V4DkJtT2jdE)
* [Article](http://h-deb.clg.qc.ca/Sujets/Divers--cplusplus/auto-when.html)
    * AAA = Almost Always Auto (Herb Sutter)
    * AAAA = Almost Always Avoid Auto (James McNellis, Michael Caisse)
    * CRA = Contextually Relevant Auto
